---
title: "Predicting Red Wine Quality Using Machine Learning"

author: "Yixuan Gao, Bryan Lee, Wangkai Zhu, Timothy Singh"
format: 
    revealjs:
        theme: simple
---
## Data Validation

<div style="display: flex; justify-content: space-between; align-items: center;">
<!-- Left Column (Text) -->
<div style="flex: 1; text-align: left; font-size: 24px;">
- Column Data Types: All columns conform to the expected data types.​<br>
  - All columns in the wine dataset is numeric​<br>
  - Standard Scaler is applied so that all data has a mean of 0 and standard deviation of 1​<br>
- Value Ranges: All columns conform to the specified range.​<br>
- Duplicate Rows: No duplicate rows were found.​<br>
- Empty Rows: No null values or rows with all null values were found.​<br>
<br>
The dataset passed all validation checks successfully. Train Test Split is applied so that we have a 80% training set 20% testing set.
</div>

<!-- Right Column (Image) -->
<div style="flex: 1; text-align: right;">
![](img/Data_validation.png){width=550 fig-align="right"}
</div>
</div>

## Exploratory Data Analysis - Target Distribution Chart

![](img/Target_distribution.png){width=500 fig-align="center"}

<div style="flex: 1;font-size: 24px;">
<h1 style="font-weight: bold;font-size: 24px;">Notable Observations:</h1>
  - Target column follows a bell shaped distribution.<br>
  - Data points although are scored from 1-10, the true range of the ratings in our data is between 3-8. 
</div>

## Exploratory Data Analysis - Feature Correlation Heatmap

<div style="display: flex; justify-content: space-between; align-items: center;">
<!-- Left Column (Text) -->
<div style="flex: 1;font-size: 30px; text-align: left;">
This heatmap highlights in our training data which features are correlated:<br>
<br>
 - Fixed acidity and citric acid levels are features which show a high level of correlation with one another<br>
 - Density and fixed acidity are correlated.<br>
 - There are also several features with a very strong negative correlation, such as pH and citric acid and pH and fixed acidity.<br> 
</div>

<!-- Right Column (Image) -->
<div style="flex: 1; text-align: right;">
![](img/features_heatmap.png){width=500 fig-align="right"}
</div>
</div>

## Exploratory Data Analysis - Feature Distribution

![](img/facet_feature_distributions.png){width=600 fig-align="center"}

<div style="flex: 1;font-size: 24px;">
<h1 style="font-weight: bold;font-size: 24px;">Feature Distributions:</h1>
  - Several of the features are normally distributed however not all are. <br>
  - Several features have multiple modes or show skewness on the right.<br>
</div>


## Analysis - Preprocessing and Model Selection

---

## Analysis - Hyperparameter Tuning

---

## Analysis - Model Evaluation


- On the testing data, we attained an **accuracy of ~58%**
- To investigate further we took a look at the confusion matries for each target level.

::: {.pull-up}
![Confusion Matrix for Red Wine Quality of 6](img/confusion_matrix_class_6.png){width=700 fig-align="center"}
:::

## Analysis - Model Evaluation

- We can see the how many wine samples were correctly (True Positives and False Positives) and incorrectly identified (False Positives and False Negatives) for each wine level

| Confusion Matrix | Correct | Incorrect |
|------------------|:--------|----------:|
| 3                | 0       |         0 |
| 4                | 0       |         0 |
| 5                | 75      |        60 |
| 6                | 76      |        51 |
| 7                | 5       |         5 |
| 8                | 0       |         0 |


- Overall, the model correctly classified $156$ red wine samples, but incorrectly classified $116$ red wine samples.

# Limitations

## Limitations on the Dataset
- There are not many imbalanced classes, and we have no data for extremely good or bad wines. A dataset with adequate data for all classes may yield a better model for generalization.
- Another dataset with features talking about the scent and taste of the wine would allow 

## Limitations on the Model
- The best model achieved **around ~58%**, indicating room for improvement.
- The targts are ordinal, so a model that takes this into account can be useful.
- Perhaps we can consider a Neural Net using Cross-Entropy Loss for Multiclass Classification.

## Limitations on the Metric
- Only accuracy was used, which does not take into account the True and false positives and true and false negatives.
- Perhaps a metric like F1 / F2 score would better represent the model.


## Conclusion

To wrap up just some summary points:


- We made a classifier that gives a rating of red wine based on chemical properties.
- The data was obtained from the UC Irvine Machine Learning Repository.
- This classifier uses a SVM RBF model, with tuned C, gamma and decision_function_shape parameters.
- Final model gave a score of **58% accuracy**. This indicates room for improvement via different data and different modeling techniques.
- While not the best model, it can still be used as a preliminary screening tool to assess wine batches before further testing, or by novel wine enthusiasts to assess their wine quality.



# Questions?

Thank you! This has been our presentation on our Wine Quality Predictor. 

We will now open the floor for any questions!